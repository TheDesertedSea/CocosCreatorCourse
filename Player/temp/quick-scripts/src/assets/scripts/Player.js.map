{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["cc","Class","Component","properties","speed","weapons","Prefab","onLoad","weaponNum","moveForward","moveBackward","moveRight","moveLeft","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","event","keyCode","macro","KEY","a","d","w","s","space","attack","weapon","node","getChildByName","getComponent","fire","changeWeapon","parent","destroy","log","instantiate","update","dt","lv","RigidBody","linearVelocity","y","x"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAEAA,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,KAAK,EAAC,GADE;AAERC,IAAAA,OAAO,EAAC,CAACL,EAAE,CAACM,MAAJ,CAFA,CAEc;;AAFd,GAHP;AAQLC,EAAAA,MARK,oBAQG;AACJ,SAAKC,SAAL,GAAe,CAAf;AACA,SAAKC,WAAL,GAAiB,KAAjB;AACA,SAAKC,YAAL,GAAkB,KAAlB;AACA,SAAKC,SAAL,GAAe,KAAf;AACA,SAAKC,QAAL,GAAc,KAAd;AACAZ,IAAAA,EAAE,CAACa,WAAH,CAAeC,EAAf,CAAkBd,EAAE,CAACe,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAoD,KAAKC,SAAzD,EAAmE,IAAnE;AACAlB,IAAAA,EAAE,CAACa,WAAH,CAAeC,EAAf,CAAkBd,EAAE,CAACe,WAAH,CAAeC,SAAf,CAAyBG,MAA3C,EAAkD,KAAKC,OAAvD,EAA+D,IAA/D;AACH,GAhBI;AAkBLC,EAAAA,SAlBK,uBAkBM;AACPrB,IAAAA,EAAE,CAACa,WAAH,CAAeS,GAAf,CAAmBtB,EAAE,CAACe,WAAH,CAAeC,SAAf,CAAyBC,QAA5C,EAAqD,KAAKC,SAA1D,EAAoE,IAApE;AACAlB,IAAAA,EAAE,CAACa,WAAH,CAAeS,GAAf,CAAmBtB,EAAE,CAACe,WAAH,CAAeC,SAAf,CAAyBG,MAA5C,EAAmD,KAAKC,OAAxD,EAAgE,IAAhE;AACH,GArBI;AAsBLF,EAAAA,SAAS,EAAC,mBAASK,KAAT,EACV;AACI,YAAOA,KAAK,CAACC,OAAb;AACG;AACC,WAAKxB,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,aAAKf,QAAL,GAAc,IAAd;AACA,aAAKD,SAAL,GAAe,KAAf;AACA;;AACJ,WAAKX,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaE,CAAlB;AACI,aAAKjB,SAAL,GAAe,IAAf;AACA,aAAKC,QAAL,GAAc,KAAd;AACA;;AACJ,WAAKZ,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaG,CAAlB;AACI,aAAKpB,WAAL,GAAiB,IAAjB;AACA,aAAKC,YAAL,GAAkB,KAAlB;AACA;;AACJ,WAAKV,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaI,CAAlB;AACI,aAAKpB,YAAL,GAAkB,IAAlB;AACA,aAAKD,WAAL,GAAiB,KAAjB;AACA;;AACJ,WAAKT,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaK,KAAlB;AACI,aAAKC,MAAL;AAnBR;AAqBH,GA7CI;AA+CLZ,EAAAA,OAAO,EAAC,iBAASG,KAAT,EACR;AACI,YAAOA,KAAK,CAACC,OAAb;AAEI,WAAKxB,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,aAAKf,QAAL,GAAc,KAAd;AACA;;AACJ,WAAKZ,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaE,CAAlB;AACI,aAAKjB,SAAL,GAAe,KAAf;AACA;;AACJ,WAAKX,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaG,CAAlB;AACI,aAAKpB,WAAL,GAAiB,KAAjB;AACA;;AACJ,WAAKT,EAAE,CAACyB,KAAH,CAASC,GAAT,CAAaI,CAAlB;AACI,aAAKpB,YAAL,GAAkB,KAAlB;AAZR;AAcH,GA/DI;;AAiEN;;;;;;;AAQCsB,EAAAA,MAAM,EAAC,kBACP;AACG;AACC,QAAIC,MAAM,GAAC,KAAKC,IAAL,CAAUC,cAAV,CAAyB,QAAzB,CAAX;AACAF,IAAAA,MAAM,CAACG,YAAP,CAAoB,QAApB,EAA8BC,IAA9B;AACH,GA9EI;AAgFLC,EAAAA,YAAY,EAAC,wBAAY;AACzB;AACI,QAAIL,MAAM,GAAC,KAAKC,IAAL,CAAUC,cAAV,CAAyB,QAAzB,CAAX;AACAF,IAAAA,MAAM,CAACM,MAAP,GAAc,IAAd;AACAN,IAAAA,MAAM,CAACO,OAAP;AACAxC,IAAAA,EAAE,CAACyC,GAAH,CAAO,KAAKjC,SAAZ;AACA,SAAKA,SAAL,GAAe,CAAC,KAAKA,SAAL,GAAe,CAAhB,IAAmB,CAAlC,CALJ,CAK0C;;AACtCyB,IAAAA,MAAM,GAACjC,EAAE,CAAC0C,WAAH,CAAe,KAAKrC,OAAL,CAAa,KAAKG,SAAlB,CAAf,CAAP;AACAyB,IAAAA,MAAM,CAACM,MAAP,GAAc,KAAKL,IAAnB;AACH,GAzFI;AA0FLS,EAAAA,MA1FK,kBA0FGC,EA1FH,EA0FO;AAAI;AACZ,SAAKC,EAAL,GAAQ,KAAKX,IAAL,CAAUE,YAAV,CAAuBpC,EAAE,CAAC8C,SAA1B,EAAqCC,cAA7C;;AACA,QAAG,KAAKtC,WAAR,EACA;AACI,WAAKoC,EAAL,CAAQG,CAAR,GAAU,KAAK5C,KAAf;AACH,KAHD,MAIK,IAAG,KAAKM,YAAR,EACL;AACI,WAAKmC,EAAL,CAAQG,CAAR,GAAU,CAAC,KAAK5C,KAAhB;AACH,KAHI,MAID;AACA,WAAKyC,EAAL,CAAQG,CAAR,GAAU,CAAV;AACH;;AACD,QAAG,KAAKrC,SAAR,EACA;AACI,WAAKkC,EAAL,CAAQI,CAAR,GAAU,KAAK7C,KAAf;AACH,KAHD,MAIK,IAAG,KAAKQ,QAAR,EACL;AACI,WAAKiC,EAAL,CAAQI,CAAR,GAAU,CAAC,KAAK7C,KAAhB;AACH,KAHI,MAID;AACA,WAAKyC,EAAL,CAAQI,CAAR,GAAU,CAAV;AACH;;AACD,SAAKf,IAAL,CAAUE,YAAV,CAAuBpC,EAAE,CAAC8C,SAA1B,EAAqCC,cAArC,GAAoD,KAAKF,EAAzD;AACH;AAnHI,CAAT","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        speed:100,\r\n        weapons:[cc.Prefab],  //存储武器预制体（武器栏）\r\n    },\r\n\r\n    onLoad(){\r\n        this.weaponNum=0;\r\n        this.moveForward=false;\r\n        this.moveBackward=false;\r\n        this.moveRight=false;\r\n        this.moveLeft=false;\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n\r\n    onDestroy(){\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n    onKeyDown:function(event)  \r\n    {\r\n        switch(event.keyCode)  \r\n        {  //w向前，s向后，a向左，d向右，space攻击\r\n            case cc.macro.KEY.a:\r\n                this.moveLeft=true;\r\n                this.moveRight=false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.moveRight=true;\r\n                this.moveLeft=false;\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                this.moveForward=true;\r\n                this.moveBackward=false;\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.moveBackward=true;\r\n                this.moveForward=false;\r\n                break;\r\n            case cc.macro.KEY.space:  \r\n                this.attack();\r\n        }\r\n    },\r\n\r\n    onKeyUp:function(event)\r\n    {\r\n        switch(event.keyCode)\r\n        {\r\n            case cc.macro.KEY.a:\r\n                this.moveLeft=false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.moveRight=false;\r\n                break;\r\n            case cc.macro.KEY.w:\r\n                this.moveForward=false;\r\n                break;\r\n            case cc.macro.KEY.s:\r\n                this.moveBackward=false;\r\n        }\r\n    },\r\n\r\n   /* attack:function()\r\n    {\r\n        cc.log(\"attack\");\r\n        var weapon=this.node.getChildByName(\"weapon\");\r\n        cc.tween(weapon).to(0.2,{rotation:90}).to(0.4,{rotation:30}).start();\r\n    },\r\n    */\r\n\r\n    attack:function()\r\n    {\r\n       // cc.log(\"attack\");   //调用武器的开火函数\r\n        var weapon=this.node.getChildByName(\"weapon\");\r\n        weapon.getComponent(\"Weapon\").fire();\r\n    },\r\n\r\n    changeWeapon:function()  //切换武器\r\n    {\r\n        var weapon=this.node.getChildByName(\"weapon\");\r\n        weapon.parent=null;\r\n        weapon.destroy();\r\n        cc.log(this.weaponNum);\r\n        this.weaponNum=(this.weaponNum+1)%2;  //取2的模以防数组越界\r\n        weapon=cc.instantiate(this.weapons[this.weaponNum]);\r\n        weapon.parent=this.node;\r\n    },\r\n    update (dt) {   //每秒给刚体组件设置线性速度\r\n        this.lv=this.node.getComponent(cc.RigidBody).linearVelocity;\r\n        if(this.moveForward)\r\n        {\r\n            this.lv.y=this.speed;\r\n        }\r\n        else if(this.moveBackward)\r\n        {\r\n            this.lv.y=-this.speed;\r\n        }\r\n        else{\r\n            this.lv.y=0;\r\n        }\r\n        if(this.moveRight)\r\n        {\r\n            this.lv.x=this.speed;\r\n        }\r\n        else if(this.moveLeft)\r\n        {\r\n            this.lv.x=-this.speed;\r\n        }\r\n        else{\r\n            this.lv.x=0;\r\n        }\r\n        this.node.getComponent(cc.RigidBody).linearVelocity=this.lv;\r\n    },\r\n});\r\n"]}